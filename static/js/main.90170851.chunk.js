(this["webpackJsonpreactive-todo"]=this["webpackJsonpreactive-todo"]||[]).push([[0],{40:function(e,t,n){},42:function(e,t,n){},50:function(e,t,n){},51:function(e,t,n){"use strict";n.r(t);var o=n(2),i=n(1),a=n.n(i),c=n(31),r=n.n(c),s=n(20),l=n(12),u=n(13),d=n(15),p=n(14),v=(n(40),n(32)),f=n(5),j=n(34),b=n(17),h=n.n(b),g=n(22),m=(n(42),function(e){Object(d.a)(n,e);var t=Object(p.a)(n);function n(){var e;Object(l.a)(this,n);for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return(e=t.call.apply(t,[this].concat(i))).wrapperRef=null,e.buttonRef=null,e.handleClickOutside=function(t){var n,o;e.wrapperRef&&(null===(n=e.wrapperRef)||void 0===n?void 0:n.contains(null===t||void 0===t?void 0:t.target))&&(e.buttonRef&&(null===(o=e.buttonRef)||void 0===o?void 0:o.contains(null===t||void 0===t?void 0:t.target))?e.props.deleteFunc(e.props.index):e.props.toggleDone(e.props.index))},e}return Object(u.a)(n,[{key:"componentDidMount",value:function(){document.addEventListener("mousedown",this.handleClickOutside)}},{key:"componentWillUnmount",value:function(){document.removeEventListener("mousedown",this.handleClickOutside)}},{key:"render",value:function(){var e=this;return Object(o.jsx)(o.Fragment,{children:Object(o.jsxs)("li",{ref:function(t){e.wrapperRef=t},className:"todoItem ".concat(this.props.item.done?"done":""),children:[" ",Object(o.jsx)("button",{ref:function(t){e.buttonRef=t},className:"deleteBtn btn",children:"\ud83d\uddd1"})," ",this.props.item.title]},this.props.item.toString())})}}]),n}(a.a.Component)),O=n(16);n(28),n(29);O.a.initializeApp({apiKey:"AIzaSyB8FQuJciTwz1cQWA78DL0J56UyY5A6sCM",authDomain:"reactive-todo-40cef.firebaseapp.com",databaseURL:"https://reactive-todo-40cef.firebaseio.com",projectId:"reactive-todo-40cef",storageBucket:"reactive-todo-40cef.appspot.com",messagingSenderId:"667961229338",appId:"1:667961229338:web:8ac758329641cac506d1a3"});var x=O.a.firestore(),w=O.a.auth(),L=function(e){Object(d.a)(n,e);var t=Object(p.a)(n);function n(e){var o;return Object(l.a)(this,n),(o=t.call(this,e)).newTodoInput=null,o.wrapperRef=null,o.componentDidMount=Object(g.a)(h.a.mark((function e(){var t,n,i;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,x.collection("user").doc(o.props.uid);case 3:return n=e.sent,e.next=6,n.get();case 6:i=e.sent,o.setState({todoList:null===(t=i.data())||void 0===t?void 0:t.todoList}),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(0),console.error(e.t0);case 13:document.addEventListener("mousedown",o.handleClickOutside);case 14:case"end":return e.stop()}}),e,null,[[0,10]])}))),o.addTodo=function(){var e=Object(g.a)(h.a.mark((function e(t){var n;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(""!==o.state.newTodo){e.next=4;break}o.setState({visible:!1}),e.next=10;break;case 4:return n={done:!1,title:o.state.newTodo},e.next=7,x.collection("user").doc(o.props.uid);case 7:e.sent.update({todoList:O.a.firestore.FieldValue.arrayUnion(n)}),o.setState({todoList:[].concat(Object(j.a)(o.state.todoList),[n]),newTodo:"",visible:!1});case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),o.toggleInput=function(){o.setState({visible:!o.state.visible,newTodo:""},(function(){var e;null===(e=o.newTodoInput)||void 0===e||e.focus()}))},o.setInput=function(e){o.setState({newTodo:e.target.value})},o.handleClickOutside=function(e){var t;o.wrapperRef&&!(null===(t=o.wrapperRef)||void 0===t?void 0:t.contains(null===e||void 0===e?void 0:e.target))&&o.toggleInput()},o.toggleDone=function(e){var t=o.state.todoList.slice();t[e].done=!t[e].done,t=t.sort((function(e,t){return e.done===t.done?0:e.done?1:-1})),o.setState({todoList:t},(function(){try{x.collection("user").doc(o.props.uid).update({todoList:o.state.todoList})}catch(e){console.error(e)}}))},o.deleteTask=function(e){var t=o.state.todoList;t.splice(e,1),o.setState({todoList:t},(function(){try{x.collection("user").doc(o.props.uid).update({todoList:o.state.todoList})}catch(e){console.error(e)}}))},o.state={todoList:[],newTodo:"",visible:!1},o}return Object(u.a)(n,[{key:"componentWillUnmount",value:function(){document.removeEventListener("mousedown",this.handleClickOutside)}},{key:"render",value:function(){var e=this;return Object(o.jsxs)(o.Fragment,{children:[Object(o.jsx)("h2",{id:"Title",children:"Todo"}),Object(o.jsxs)("div",{className:"todoWrapper",children:[Object(o.jsx)("ul",{className:"todoItemList",children:this.state.todoList.map((function(t,n){return Object(o.jsx)(m,{index:n,deleteFunc:e.deleteTask,toggleDone:e.toggleDone,item:t},n)}))}),this.state.visible?Object(o.jsxs)("div",{className:"inputWrapper",ref:function(t){e.wrapperRef=t},children:[Object(o.jsx)("input",{ref:function(t){e.newTodoInput=t},onChange:this.setInput,value:this.state.newTodo,type:"text",id:"newTodoInput"}),Object(o.jsx)("button",{className:"doneBtn",onClick:function(t){return e.addTodo(t)},children:"\u2714"})]}):null,Object(o.jsx)("button",{className:"addBtn btn",onClick:function(t){return e.toggleInput()},children:"Add"})]})]})}}]),n}(a.a.Component),k=n.p+"static/media/google.6a4a3529.svg",y=function(e){Object(d.a)(n,e);var t=Object(p.a)(n);function n(){var e;Object(l.a)(this,n);for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return(e=t.call.apply(t,[this].concat(i))).googleLogin=function(){var t=new O.a.auth.GoogleAuthProvider;w.signInWithPopup(t).then(function(){var t=Object(g.a)(h.a.mark((function t(n){var o,i,a,c,r,s,l,u,d;return h.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i=x.collection("user").doc(null===n||void 0===n||null===(o=n.user)||void 0===o?void 0:o.uid),t.next=3,i.get();case 3:if(!(a=t.sent).exists){t.next=8;break}e.finalizeLogin(a.data()),t.next=11;break;case 8:return t.next=10,i.set({displayName:null===n||void 0===n||null===(c=n.user)||void 0===c?void 0:c.displayName,email:null===n||void 0===n||null===(r=n.user)||void 0===r?void 0:r.email,id:null===n||void 0===n||null===(s=n.user)||void 0===s?void 0:s.uid,todoList:[]});case 10:e.finalizeLogin({displayName:null===n||void 0===n||null===(l=n.user)||void 0===l?void 0:l.displayName,email:null===n||void 0===n||null===(u=n.user)||void 0===u?void 0:u.email,id:null===n||void 0===n||null===(d=n.user)||void 0===d?void 0:d.uid,todoList:[]});case 11:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()).catch((function(e){console.error(e)}))},e.finalizeLogin=function(t){try{console.log(t),localStorage.setItem("uid",JSON.stringify(null===t||void 0===t?void 0:t.id)),localStorage.setItem("logged",(!0).toString()),localStorage.setItem("user",JSON.stringify(t)),e.props.loginCallback(t,null===t||void 0===t?void 0:t.id)}catch(n){console.error(n)}},e}return Object(u.a)(n,[{key:"render",value:function(){return Object(o.jsxs)(o.Fragment,{children:[Object(o.jsx)("h1",{children:"Login"}),Object(o.jsxs)("button",{className:"googleBtn",children:[Object(o.jsx)("div",{className:"imgWrapper",children:Object(o.jsx)("img",{src:k,alt:""})}),Object(o.jsx)("span",{onClick:this.googleLogin,className:"googleBtnTitle",children:"Login with google"})]})]})}}]),n}(a.a.Component),S=function(e){Object(d.a)(n,e);var t=Object(p.a)(n);function n(e){var o;return Object(l.a)(this,n),(o=t.call(this,e)).successfullLogin=function(e,t){console.log("helloworld"),o.setState({user:e,isAuthenticated:!0,uid:t},(function(){console.log(o.state),window.location.href="/"}))},o.state={isAuthenticated:!1,uid:"",user:null},o}return Object(u.a)(n,[{key:"componentDidMount",value:function(){try{var e=localStorage.getItem("logged"),t=JSON.parse(e||"false");if(console.log(t),t){var n=localStorage.getItem("user"),o=JSON.parse(n||""),i=localStorage.getItem("uid");i=JSON.parse(i||""),this.setState({user:o,uid:i||"",isAuthenticated:!0},(function(){}))}}catch(a){console.log({err:a})}}},{key:"render",value:function(){var e=this;return Object(o.jsx)(v.a,{children:Object(o.jsx)("div",{className:"App",children:Object(o.jsx)("main",{className:"App-body",children:Object(o.jsxs)(f.c,{children:[Object(o.jsx)(f.a,{path:"/login",render:function(t){return Object(o.jsx)(y,Object(s.a)(Object(s.a)({},t),{},{loginCallback:e.successfullLogin}))}}),this.state.isAuthenticated?Object(o.jsx)(o.Fragment,{children:Object(o.jsx)(f.a,{path:"/",render:function(t){return Object(o.jsx)(L,Object(s.a)(Object(s.a)({},t),{},{uid:e.state.uid}))}})}):Object(o.jsx)(f.a,{path:"/",render:function(t){return Object(o.jsx)(y,Object(s.a)(Object(s.a)({},t),{},{loginCallback:e.successfullLogin}))}}),Object(o.jsx)(f.a,{render:function(){return Object(o.jsx)("h1",{children:"404: page not found"})}})]})})})})}}]),n}(a.a.Component);n(50);r.a.render(Object(o.jsx)(a.a.StrictMode,{children:Object(o.jsx)(S,{})}),document.getElementById("root"))}},[[51,1,2]]]);
//# sourceMappingURL=main.90170851.chunk.js.map